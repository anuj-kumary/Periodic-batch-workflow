name: sysmail_verify_addressparams_sp
fullyQualifiedName: MSSQL_TEST.msdb.dbo.sysmail_verify_addressparams_sp
storedProcedureCode:
  language: SQL
  code: "\r\nCREATE   PROCEDURE dbo.sysmail_verify_addressparams_sp\r\n  @address\
    \          VARCHAR(MAX),\r\n  @parameter_name   NVARCHAR(32)\r\nAS\r\n  IF ((@address\
    \ IS NOT NULL) AND (@address != N''))\r\n  BEGIN\r\n\r\n    DECLARE @curr_char\
    \ NVARCHAR(1)\r\n    DECLARE @curr_char_index INT\r\n    DECLARE @in_double_quotes\
    \ BIT\r\n    DECLARE @error_at INT\r\n\r\n    SET @curr_char = N''        -- current\
    \ character being analyzed\r\n    SET @curr_char_index = 1    -- position of current\
    \ character being analyzed\r\n    SET @in_double_quotes = 0   -- flag (1=within\
    \ double quotes; 0 otherwise)\r\n    SET @error_at = 0           -- position (starting\
    \ at 1) where the illegal comma was detected\r\n\r\n    WHILE @curr_char_index\
    \ <= len(@address)\r\n    BEGIN\r\n        SET @curr_char = substring(@address,\
    \ @curr_char_index, 1)\r\n        IF @curr_char = N'\"'\r\n          SET @in_double_quotes\
    \ = CASE @in_double_quotes WHEN 0 THEN 1 ELSE 0 END\r\n\r\n        IF @curr_char\
    \ = N','\r\n          SET @error_at = CASE @in_double_quotes WHEN 1 THEN 0 ELSE\
    \ @curr_char_index END\r\n\r\n        IF @error_at > 0 BREAK\r\n\r\n        SET\
    \ @curr_char_index = @curr_char_index + 1\r\n    END\r\n\r\n    IF @error_at >\
    \ 0 \r\n    BEGIN\r\n      -- Comma is the wrong format to separate addresses.\
    \ Users should use the semicolon \";\".\r\n      RAISERROR(14613, 16, 1, @parameter_name,\
    \ @address)\r\n      RETURN(1)\r\n    END\r\n\r\n  END\r\n\r\n  RETURN(0) -- SUCCESS\r\
    \n"
dataProducts: []
databaseSchema:
  id: 57c2f396-9b05-4e00-9903-62b0219fbc25
  type: databaseSchema
  name: dbo
  fullyQualifiedName: MSSQL_TEST.msdb.dbo
  displayName: dbo
  deleted: false
database:
  id: af8db866-dbb4-4bd5-a2ea-22202fbc71ef
  type: database
  name: msdb
  fullyQualifiedName: MSSQL_TEST.msdb
  displayName: msdb
  deleted: false
service:
  id: 1ef4c8da-1280-42c0-8b83-142c3a019de7
  type: databaseService
  name: MSSQL_TEST
  fullyQualifiedName: MSSQL_TEST
  description: ""
  displayName: MSSQL_TEST
  deleted: false
serviceType: Mssql
owners: []
tags: []
domains: []
sourceHash: 3c576bcb1f559fd2344ec9d7192e58a8
processedLineage: false
entityStatus: Approved
