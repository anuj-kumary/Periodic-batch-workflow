name: table_1192
fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_1192
tableType: View
columns:
  - name: id
    dataType: BIGINT
    dataTypeDisplay: bigint
    fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_1192.id
    tags: []
    children: []
    customMetrics: []
owners: []
databaseSchema:
  id: 46334aff-5d83-4872-94c8-902145192247
  type: databaseSchema
  name: test-schema
  fullyQualifiedName: test-service-db-lineage.test-db.test-schema
  displayName: test-schema
  deleted: false
database:
  id: 252ee8f8-11a2-4af5-bf4b-05dcda48e1ec
  type: database
  name: test-db
  fullyQualifiedName: test-service-db-lineage.test-db
  displayName: test-db
  deleted: false
service:
  id: 7088ea8b-d5a8-4adf-bff1-a539758cd4ea
  type: databaseService
  name: test-service-db-lineage
  fullyQualifiedName: test-service-db-lineage
  displayName: test-service-db-lineage
  deleted: false
serviceType: Snowflake
schemaDefinition: "create or replace view PPR_RPT_PARTNER_PROGRAM_SUMMARY_RESALE(\n\
  \t\"ParentPartner\",\n\t\"ParentPartnerNumber\",\n\t\"ProgramType\",\n\t\"ParentPartnerGeo\"\
  ,\n\t\"ParentPartnerPublicSectorFlag\",\n\t\"CurrentProgramSegment\",\n\t\"CalculatedProgramSegment\"\
  ,\n\t\"Upward/DownwardChangeinSegmentFlag\",\n\t\"ChangeInSegmentDate\",\n\t\"DailyChangeFlag\"\
  ,\n\t\"DeleteFlagMonthly\"\n) as\n\n/*********************************************************************************************************************\n\
  \ \t\t* Project  Name              :     Partner Program Redesign\n \t\t* Project\
  \ \t\t\t\t\t :\n \t\t* Object Name \t\t\t\t :     PPR_RPT_PARTNER_PROGRAM_SUMMARY_RESALE\n\
  \ \t\t* Development Request # \t :\n \t\t* Brief Description          :\n \t\t*\
  \ Developed By               :     Vaidehi\n \t\t* Date Created               :\
  \ \t   2023-02-10\n \t\t* ---------------------------------------------------------------------------------------------------------------\n\
  \ \t\t* REVISION HISTORY:SFSTRY0091234 -  01-06-2023     Vaidehi         Data Fix\
  \ for missing parentpartner due to null ResellerSegment\n          -- Data fix for\
  \ ChangeInSegmentDate\n\n \t\t*INC0966932-xtype.io LTD shows different program segment\
  \ than criteria segment\n        * SFSTRY0091234  -  17-01-2023     Pruthviraj \
  \     Change Current Segment logic for respective Program module\n        * SFSTRY0102990\t\
  \    Dec-06-2023\t   Pruthviraj      Added Current Program Segments for all programs\
  \ : SP/CIPP/Resale/GE/Build\n \t\t*----------------------------------------------------------------------------------------------------------------\n\
  \n ********************************************************************************************************************************/\n\
  (\n     WITH  PAR_PARTNERS AS (SELECT * FROM EDW_LS.\"PARTNER_EM\".\"PARENTPARTNERS\"\
  \ WHERE \"ParentPartnerCategory\" !='random' OR \"ParentPartnerCategory\" IS NULL\
  \ ),\n    PARTNERS AS ( SELECT DISTINCT P.\"ParentPartnerNumber\",P.\"ParentPartner\"\
  ,PP.\"ParentPartnerGeo\",PP.\"ResellerSegment\"  FROM EDW_LS.PARTNER_EM.PARTNERS\
  \ P\nINNER JOIN  PAR_PARTNERS PP\nON P.\"ParentPartnerNumber\" = PP.\"ParentPartnerNumber\"\
  \nWHERE  P.\"PartnerSalesTierLevel\" = 'random'\nAND (\"ParentPartnerCategory\"\
  \ != 'random' or \"ParentPartnerCategory\" IS NULL) )\nSELECT DISTINCT \"ParentPartner\"\
  ,\n\t\"ParentPartnerNumber\",\n\t\"ProgramType\",\n    \"ParentPartnerGeo\",\n \
  \   \"ParentPartnerPublicSectorFlag\",\n\t\"CurrentProgramSegment\",\n\t \"CalculatedProgramSegment1\"\
  \ as \"CalculatedProgramSegment\",\n\t\"Upward/DownwardChangeinSegmentFlag\",\n\t\
  \"ChangeInSegmentDate\",\n\t\"DailyChangeFlag\",\n\t\"DeleteFlagMonthly\" FROM\n\
  \    (  SELECT DISTINCT P.\"ParentPartner\",P.\"ParentPartnerNumber\", R.\"ProgramType\"\
  ,P.\"ParentPartnerGeo\", A.\"ParentPartnerPublicSectorFlag\", P.\"ResellerSegment\"\
  \ AS \"CurrentProgramSegment\", NVL(\"DerivedProgramSegment\",'random') AS \"CalculatedProgramSegment1\"\
  ,\n\n    CASE WHEN \"CurrentProgramSegment\"='random' THEN 'random' WHEN \"CurrentProgramSegment\"\
  ='random' THEN 'random' WHEN \"CurrentProgramSegment\"='random' THEN 'random'\n\
  \    WHEN \"CurrentProgramSegment\"='random' THEN 'random' WHEN \"CurrentProgramSegment\"\
  ='random' THEN 'random' ELSE 'random' END AS \"CurrentProgramSegmentnum\"\n    ,\n\
  \     CASE WHEN \"CalculatedProgramSegment1\"='random' THEN 'random' WHEN \"CalculatedProgramSegment1\"\
  ='random' THEN 'random' WHEN \"CalculatedProgramSegment1\"='random' THEN 'random'\n\
  \    WHEN \"CalculatedProgramSegment1\"='random' THEN 'random' WHEN \"CalculatedProgramSegment1\"\
  ='random' THEN 'random' ELSE 'random' END AS \"CalculatedProgramSegmentnum\"\n \
  \   ,\n    CASE WHEN \"CurrentProgramSegmentnum\"<\"CalculatedProgramSegmentnum\"\
  \ THEN 'random'\n    WHEN \"CurrentProgramSegmentnum\">\"CalculatedProgramSegmentnum\"\
  \ THEN 'random'\n    WHEN \"CurrentProgramSegmentnum\"=\"CalculatedProgramSegmentnum\"\
  \ THEN 'random'\n    ELSE 'random' end\n    AS \"Upward/DownwardChangeinSegmentFlag\"\
  ,\n     TO_DATE(convert_timezone('random', current_timestamp()))\n    AS \"ChangeInSegmentDate\"\
  \n\n    , 'random' AS \"DailyChangeFlag\", 'random' AS \"DeleteFlagMonthly\"\n \
  \   FROM PARTNERS P\n    LEFT JOIN\n (\nSELECT DISTINCT \"ParentPartner\",\"ParentPartnerNumber\"\
  ,\"ProgramType\",\"ParentPartnerPublicSectorFlag\", \"DERIVED_SEGMENT_2\" AS \"\
  DerivedProgramSegment\"--INC0966932\n--,\"DERIVED_SEGMENT\" as \"without12countcheck\"\
  \n--NULL AS \"Upward/DownwardChangeinSegmentFlag\", NULL AS \"ChangeInSegmentDate\"\
  , NULL AS \"DailyChangeFlag\", NULL AS \"DeleteFlagMonthly\"\nFROM (SELECT \"ParentPartner\"\
  ,\"ParentPartnerNumber\",\"ProgramType\",\"ParentPartnerPublicSectorFlag\",--,MIN(\"\
  RANKING\") AS \"MINRANKING\"\nmin(\"RANKING\")   over (partition by \"ParentPartner\"\
  ,\"ParentPartnerNumber\",\"ProgramType\" order by \"ParentPartner\",\"ParentPartnerNumber\"\
  ,\"ProgramType\") AS \"WINDOW_RANKING\",\nCOUNT(\"RANKING\")   over (partition by\
  \ \"ParentPartner\",\"ParentPartnerNumber\",\"ProgramType\" order by \"ParentPartner\"\
  ,\"ParentPartnerNumber\",\"ProgramType\") AS \"WINDOW_COUNT\",\n--CASE WHEN \"WINDOW_RANKING\"\
  =0 THEN NULL WHEN \"WINDOW_RANKING\"=2 THEN 'Premier' WHEN \"WINDOW_RANKING\"=3\
  \ THEN 'Elite' WHEN \"WINDOW_RANKING\"=1 THEN 'Specialist' ELSE NULL END AS \"DERIVED_SEGMENT\"\
  ,\nIFF(\"WINDOW_COUNT\"=\"Criteria_Count\",CASE WHEN \"WINDOW_RANKING\"='random'\
  \ THEN 'random' WHEN \"WINDOW_RANKING\"='random' THEN 'random' WHEN \"WINDOW_RANKING\"\
  ='random' THEN 'random' WHEN \"WINDOW_RANKING\"='random' THEN 'random' ELSE 'random'\
  \ END,\n   'random') AS \"DERIVED_SEGMENT_2\"\nFROM\n(SELECT *,CASE WHEN \"CurrentCriteriaSegment\"\
  ='random' THEN 'random'\nWHEN \"CurrentCriteriaSegment\"='random' THEN 'random'\n\
  WHEN \"CurrentCriteriaSegment\"='random' THEN 'random'\nELSE 'random' END AS \"\
  RANKING\"\nFROM (\nSELECT * FROM CDL_LS.PARTNER_RPT.PPR_RPT_PARTNER_PROGRAM_EVALUATION_UNIFIED\
  \ WHERE \"ProgramType\" = 'random'))\n--WHERE \"ParentPartnerNumber\"= 'ACCT0095343'\n\
  INNER JOIN\n(SELECT COUNT(DISTINCT \"CriteriaName\") AS \"Criteria_Count\" FROM\
  \ ODS_LS.PARTNER.X_SNC_4C_PARTNER_F_3C_RULES WHERE \"ProgramType\" = 'random' AND\
  \ \"Active\" = 'random') RULES\nON  \"ProgramType\"='random'\n     )\n      ) A\n\
  \n    ON P.\"ParentPartnerNumber\" = A.\"ParentPartnerNumber\"\n  LEFT JOIN ODS_LS.PARTNER.X_SNC_4C_PARTNER_F_3C_RULES\
  \ R\n  ON  R.\"ProgramType\" = 'random' AND \"Active\" = 'random'\n\n  )\n   );"
tags: []
joins:
  startDate: 2026-01-07
  dayCount: 30
  columnJoins: []
  directTableJoins: []
customMetrics: []
domains: []
dataProducts: []
processedLineage: false
entityStatus: Approved
